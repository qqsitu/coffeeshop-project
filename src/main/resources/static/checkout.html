<table id="checkoutTable">
<thead>
<tr>
    <th>Payment ID</th>
    <th>Order ID</th>
    <th>Customer</th>
    <th>Amount</th>
    <th>Status</th>
    <th>Payment Date</th>
    <th>Actions</th>
</tr>
</thead>
<tbody></tbody>

</table>
    <script>
    const paymentUrl = 'http://localhost:8080/api/payment';
    
    function fetchPayments(){
        fetch(paymentUrl)
            .then(res=>res.json())
            .then(data=>{
                const tbody = document.querySelector('#checkoutTable tbody');
                tbody.innerHTML='';
                data.forEach(pay=>{
                    const row = document.createElement('tr');
                    row.innerHTML=`
                        <td>${pay.payment_id}</td>
                        <td>${pay.order ? pay.order.order_id : ''}</td>
                        <td>${pay.order && pay.order.customer ? pay.order.customer.f_name+' '+pay.order.customer.l_name : ''}</td>
                        <td>${pay.amount.toFixed(2)}</td>
                        <td>
                            <select class="edit-status">
                                <option value="pending" ${pay.status=='pending'?'selected':''}>Pending</option>
                                <option value="completed" ${pay.status=='completed'?'selected':''}>Completed</option>
                            </select>
                        </td>
                        <td>${new Date(pay.payment_date).toLocaleString()}</td>
                        <td>
                            <button class="btn" onclick="updatePayment(${pay.payment_id}, this)">Update</button>
                            <button class="btn secondary" onclick="deletePayment(${pay.payment_id})">Delete</button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            });
    }
    
    fetchPayments();
    
    function updatePayment(id, btn){
        const row = btn.closest('tr');
        const updated = {
            status: row.querySelector('.edit-status').value
        };
        fetch(`${paymentUrl}/${id}`, {method:'PUT', headers:{'Content-Type':'application/json'}, body: JSON.stringify(updated)})
            .then(res=>{if(res.ok) fetchPayments()});
    }
    
    function deletePayment(id){
        if(confirm('Delete this payment?')){
            fetch(`${paymentUrl}/${id}`, {method:'DELETE'}).then(res=>{if(res.ok) fetchPayments()});
        }
    }
    
    </script>
    